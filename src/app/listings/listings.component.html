<div class="container py-4">
  <!-- Heading + filters -->
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-4">
    <h3 class="mb-3 mb-md-0">
      Our Properties
      <small class="text-muted ml-2">({{ filtered.length }})</small>
    </h3>

    <div class="filters d-flex flex-column flex-md-row">
      <div class="form-group mb-2 mb-md-0 mr-md-2">
        <select class="form-control" [(ngModel)]="statusFilter" (change)="applyFilters()">
          <option value="">All Status</option>
          <option value="Available">Available</option>
          <option value="Sold">Sold</option>
          <option value="Book">Book</option>

        </select>
      </div>

      <div class="form-group mb-2 mb-md-0 mr-md-2">
        <input
          class="form-control"
          placeholder="Filter by location"
          [(ngModel)]="locationFilter"
          (input)="applyFilters()"
        />
      </div>

      <button class="btn btn-outline-secondary" (click)="resetFilters()">Reset</button>
    </div>
  </div>

  <!-- Cards -->
  <div class="row">
    <div class="col-md-4 mb-4" *ngFor="let p of filtered">
      <div class="card h-100 shadow-sm project-card">
        <div class="img-wrapper">
          <img [src]="p.images[0]" class="card-img-top" alt="{{ p.name }}" />
          <span class="badge status"
                [ngClass]="{
                  'badge-success': p.status === 'Available',
                  'badge-danger': p.status === 'Sold',
                  'badge-warning': p.status === 'Book'
                }">
                {{ p.status }}
          </span>
        </div>
        
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ p.name }}</h5>
          <p class="text-muted mb-1">
            <i class="fas fa-map-marker-alt mr-1"></i> {{ p.location }}
          </p>
          <p class="mb-2">{{ p.short }}</p>

          <div class="mt-auto">
            <strong>{{ p.price }}</strong>

            <!-- Available -->
            <button *ngIf="p.status === 'Available'"
                    class="btn btn-primary btn-sm w-100 mt-2"
                    (click)="open(p.id)">
              View Details
            </button>

            <!-- Book -->
            <button *ngIf="p.status === 'Book'"
                    class="btn btn-warning btn-sm w-100 mt-2">
              Enquire Now
            </button>

            <!-- Sold -->
            <button *ngIf="p.status === 'Sold'"
                    class="btn btn-secondary btn-sm w-100 mt-2"
                    disabled>
              Sold Out
            </button>

            <!-- âœ… WHATSAPP BUTTON (ALWAYS VISIBLE) -->
            <a class="btn btn-success btn-sm w-100 mt-2"
              [href]="getWhatsappLink(p)"
              target="_blank">
              Enquire on WhatsApp
            </a>
          </div>


        </div>
      </div>
    </div>

    <div *ngIf="filtered.length === 0" class="col-12 text-center text-muted">
      No properties match your filters.
    </div>
  </div>
</div>

<div *ngIf="statusFilter || locationFilter"
     class="mt-2 text-muted small">
  Showing filtered results
</div>
